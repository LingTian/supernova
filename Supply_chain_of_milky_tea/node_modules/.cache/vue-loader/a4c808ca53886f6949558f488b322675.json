{"remainingRequest":"/home/hong/code/Supply_chain_of_milky_tea/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hong/code/Supply_chain_of_milky_tea/src/components/Retailer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hong/code/Supply_chain_of_milky_tea/src/components/Retailer.vue","mtime":1564828008616},{"path":"/home/hong/code/Supply_chain_of_milky_tea/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hong/code/Supply_chain_of_milky_tea/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hong/code/Supply_chain_of_milky_tea/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hong/code/Supply_chain_of_milky_tea/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n\nconst { createU3, U3Utils } = require(\"u3.js\");\nconst config = require(\"../../config\");\nexport default {\n  methods: {\n    data() {\n      return {\n        upc: 0\n      };\n    },\n\n    async receive () {\n      console.log(\"harvest\")\n      // TODO: 读取upc的值\n      // TODO: 发起harvest的交易\n      /*\n      config.keyProvider = \"5KXYYEWSFRWfNVrMPaVcxiRTjD9PzHjBSzxhA9MeQKHPMxWP8kU\"; // tom\n      let creator = \"ben\";\n      const u3 = createU3(config);\n      let contract = await u3.contract(creator);\n      await contract.receive(this.upc, Date.now(), {authorization: [`tom@active`]})\n      */\n\n      const u3 = createU3(config);\n      const contract = 'dremofly1'\n      const action = 'receive'\n      const params = [this.upc, Date.now()]\n      const result = await window.Cona.getCurrentNetworkChains()\n      if(result.success) {\n        const tx = await window.Cona.callContract({ contract, action, params, chainId: result.data[1]._id });\n        console.log(tx)\n      } else {\n        console.log(reuslt.msg)\n      }\n\n      // 查询状态\n      const farmerstable = \"state\";\n\t\t const farmerscope = \"s.state\";\n\t\t let farmers = await u3.getTableRecords({\n\t\t\t \"json\": true,\n\t\t\t \"code\": creator,\n\t\t\t \"scope\": farmerscope,\n\t\t\t \"table\": farmerstable\n\t\t });\n\t\t console.log(farmers.rows)\n    }\n}\n}\n",{"version":3,"sources":["Retailer.vue"],"names":[],"mappings":";;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Retailer.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <h1>Retailer</h1><br>\n    UPC\n    <input type=\"number\" id=\"upc\" name=\"upc\" v-model=\"upc\" number><br><br>\n    <el-button @click=\"receive\" type=\"primary\">Receive</el-button>\n  </div>\n</template>\n\n<script>\nconst { createU3, U3Utils } = require(\"u3.js\");\nconst config = require(\"../../config\");\nexport default {\n  methods: {\n    data() {\n      return {\n        upc: 0\n      };\n    },\n\n    async receive () {\n      console.log(\"harvest\")\n      // TODO: 读取upc的值\n      // TODO: 发起harvest的交易\n      /*\n      config.keyProvider = \"5KXYYEWSFRWfNVrMPaVcxiRTjD9PzHjBSzxhA9MeQKHPMxWP8kU\"; // tom\n      let creator = \"ben\";\n      const u3 = createU3(config);\n      let contract = await u3.contract(creator);\n      await contract.receive(this.upc, Date.now(), {authorization: [`tom@active`]})\n      */\n\n      const u3 = createU3(config);\n      const contract = 'dremofly1'\n      const action = 'receive'\n      const params = [this.upc, Date.now()]\n      const result = await window.Cona.getCurrentNetworkChains()\n      if(result.success) {\n        const tx = await window.Cona.callContract({ contract, action, params, chainId: result.data[1]._id });\n        console.log(tx)\n      } else {\n        console.log(reuslt.msg)\n      }\n\n      // 查询状态\n      const farmerstable = \"state\";\n\t\t const farmerscope = \"s.state\";\n\t\t let farmers = await u3.getTableRecords({\n\t\t\t \"json\": true,\n\t\t\t \"code\": creator,\n\t\t\t \"scope\": farmerscope,\n\t\t\t \"table\": farmerstable\n\t\t });\n\t\t console.log(farmers.rows)\n    }\n}\n}\n</script>\n"]}]}